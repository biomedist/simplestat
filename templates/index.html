<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>T-검정 통계 웹앱</title>
  <link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@400;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Pretendard', Arial, sans-serif;
      background: #f7f9fb;
      margin: 0;
      padding: 0;
    }
    .container {
      max-width: 800px;
      margin: 40px auto;
      padding: 24px;
      background: #fff;
      border-radius: 16px;
      box-shadow: 0 4px 24px rgba(0,0,0,0.07);
    }
    h1 {
      text-align: center;
      color: #2563eb;
      margin-bottom: 32px;
    }
    .section {
      margin-bottom: 32px;
      padding: 24px;
      border-radius: 12px;
      background: #f1f5f9;
      box-shadow: 0 2px 8px rgba(0,0,0,0.03);
    }
    .section:last-child {
      margin-bottom: 0;
    }
    .section-title {
      font-size: 1.2rem;
      font-weight: 700;
      color: #1e293b;
      margin-bottom: 16px;
    }
    input[type="file"] {
      display: block;
      margin-bottom: 12px;
    }
    button {
      background: #2563eb;
      color: #fff;
      border: none;
      padding: 10px 24px;
      border-radius: 6px;
      font-size: 1rem;
      cursor: pointer;
      transition: background 0.2s;
    }
    button:hover {
      background: #1d4ed8;
    }
    .result, .interpretation {
      font-size: 1rem;
      color: #334155;
    }
    @media (max-width: 600px) {
      .container {
        padding: 8px;
      }
      .section {
        padding: 12px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>통계분석 웹앱</h1>
    <!-- 상단 메뉴 -->
    <nav style="margin-bottom:32px; text-align:center;">
      <span style="font-weight:700; color:#2563eb; font-size:1.1rem;">통계분석</span>
      <span style="margin-left:16px; color:#64748b;">|</span>
      <span style="margin-left:16px; color:#2563eb; cursor:pointer; font-weight:500;">t-test</span>
      <span style="margin-left:16px; color:#2563eb; cursor:pointer; font-weight:500;">ANOVA</span>
    </nav>
    <!-- 1. 파일업로드 -->
    <div class="section">
      <div class="section-title">1. 파일 업로드</div>
      <form method="post" enctype="multipart/form-data" style="display:inline-block;">
        <input type="file" name="file" accept=".xlsx,.csv" required>
        <button type="submit">업로드</button>
      </form>
      <button type="button" onclick="location.href='/'" style="margin-left:10px; background:#e0e7ef; color:#2563eb; border:none; padding:10px 18px; border-radius:6px; font-size:1rem; cursor:pointer;">분석 초기화</button>
    </div>
    <!-- 2. 통계분석(분석방법 선택) -->
    <div class="section">
      <div class="section-title">2. 통계 분석 방법 선택</div>
      <form method="post" enctype="multipart/form-data" style="margin-bottom:0; display:flex; align-items:center; gap:12px;">
        <label for="analysis_method" style="font-weight:500;">분석 방법:</label>
        <select id="analysis_method" name="analysis_method" style="padding:6px 12px; border-radius:6px; border:1px solid #cbd5e1;">
          <option value="paired">Paired t-test</option>
          <option value="independent" selected>Independent t-test</option>
          <option value="anova">ANOVA</option>
        </select>
        <button type="button" onclick="showHelp()" style="margin-left:8px; font-size:0.85rem; padding:4px 10px; border-radius:5px; border:none; background:#e0e7ef; color:#2563eb; cursor:pointer;">HELP</button>
      </form>
      <script>
        function showHelp() {
          alert(
            '데이터 입력 예시:\n' +
            '\n[Independent t-test] 또는 [Paired t-test]:\n' +
            '- 엑셀 파일(.xlsx) 또는 CSV 파일의 앞 2개 컬럼을 사용합니다.\n' +
            '- 각 컬럼은 한 그룹의 데이터를 의미합니다.\n' +
            '- 예시)\n' +
            '  | 그룹1 | 그룹2 |\n' +
            '  |-------|-------|\n' +
            '  |  5.1  |  4.9  |\n' +
            '  |  5.7  |  5.0  |\n' +
            '\n[ANOVA]:\n' +
            '- 3개 이상의 그룹(컬럼)이 필요합니다. 각 컬럼이 하나의 그룹입니다.\n' +
            '- 예시)\n' +
            '  | 그룹1 | 그룹2 | 그룹3 |\n' +
            '  |-------|-------|-------|\n' +
            '  |  5.1  |  4.9  |  6.2  |\n' +
            '  |  5.7  |  5.0  |  6.1  |'
          );
        }
      </script>
    </div>
    <!-- 3. 통계결과 -->
    <div class="section">
      <div class="section-title">3. 통계 결과</div>
      <div class="result">
        {% if result %}
          <table style="width:100%; border-collapse:collapse; margin-bottom:18px;">
            <thead>
              <tr style="background:#e0e7ef;">
                <th style="padding:8px; border:1px solid #cbd5e1;">항목</th>
                <th style="padding:8px; border:1px solid #cbd5e1;">{{ result.column1 }}</th>
                <th style="padding:8px; border:1px solid #cbd5e1;">{{ result.column2 }}</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td style="padding:8px; border:1px solid #cbd5e1;">평균</td>
                <td style="padding:8px; border:1px solid #cbd5e1;">{{ result.mean1 }}</td>
                <td style="padding:8px; border:1px solid #cbd5e1;">{{ result.mean2 }}</td>
              </tr>
              <tr>
                <td style="padding:8px; border:1px solid #cbd5e1;">표준편차</td>
                <td style="padding:8px; border:1px solid #cbd5e1;">{{ result.std1 }}</td>
                <td style="padding:8px; border:1px solid #cbd5e1;">{{ result.std2 }}</td>
              </tr>
              <tr>
                <td style="padding:8px; border:1px solid #cbd5e1;">분산</td>
                <td style="padding:8px; border:1px solid #cbd5e1;">{{ result.var1 }}</td>
                <td style="padding:8px; border:1px solid #cbd5e1;">{{ result.var2 }}</td>
              </tr>
            </tbody>
          </table>
          <table style="width:100%; border-collapse:collapse;">
            <tbody>
              <tr>
                <td style="padding:8px; border:1px solid #cbd5e1; width:30%;">t 값</td>
                <td style="padding:8px; border:1px solid #cbd5e1;">{{ result.t_statistic }}</td>
              </tr>
              <tr>
                <td style="padding:8px; border:1px solid #cbd5e1;">자유도(df)</td>
                <td style="padding:8px; border:1px solid #cbd5e1;">{{ result.df }}</td>
              </tr>
              <tr>
                <td style="padding:8px; border:1px solid #cbd5e1;">p-value</td>
                <td style="padding:8px; border:1px solid #cbd5e1;">{{ result.p_value }}</td>
              </tr>
              <tr>
                <td style="padding:8px; border:1px solid #cbd5e1;">유의수준(α)</td>
                <td style="padding:8px; border:1px solid #cbd5e1;">{{ result.alpha }}</td>
              </tr>
              <tr>
                <td style="padding:8px; border:1px solid #cbd5e1;">Effect size (Cohen's d)</td>
                <td style="padding:8px; border:1px solid #cbd5e1;">{{ result.cohen_d }}</td>
              </tr>
            </tbody>
          </table>
        {% else %}
          <span style="color:#94a3b8;">분석 결과가 여기에 표시됩니다.</span>
        {% endif %}
      </div>
    </div>
    <!-- 4. 통계해석 -->
    <div class="section">
      <div class="section-title">4. 통계 해석</div>
      <div class="interpretation">
        {% if interpretation %}
          {{ interpretation|safe }}
        {% else %}
          <span style="color:#94a3b8;">통계 결과에 대한 해석이 여기에 표시됩니다.</span>
        {% endif %}
      </div>
    </div>
  </div>
</body>
</html>
